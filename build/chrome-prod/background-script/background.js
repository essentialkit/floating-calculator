var IS_DEV_BUILD=false;
(()=>{var r=class{constructor(){this.RELOAD_ACTION={menu:{id:"reload-extension",title:"Reload Extension",visible:!0,contexts:["action"]},handler:e=>{chrome.runtime.reload()}};this.POPUP_WINDOW_ACTION={menu:{id:"popup-calculator",title:"Open as Popup Window",visible:!0,contexts:["action"]},handler:e=>{chrome.windows.create({url:`chrome-extension://${chrome.i18n.getMessage("@@extension_id")}/standalone/calc.html`,type:"popup",width:440,height:360},function(n){})}};this.NEW_TAB_ACTION={menu:{id:"newtab-calculator",title:"Open as New Tab",visible:!0,contexts:["action"]},handler:e=>{chrome.tabs.create({url:`chrome-extension://${chrome.i18n.getMessage("@@extension_id")}/standalone/calc.html`,active:!0},()=>{console.log("successfully created Floating Calculator tab")})}};this.browserActionContextMenu=[this.POPUP_WINDOW_ACTION,this.NEW_TAB_ACTION,this.RELOAD_ACTION];this.init=()=>{if(!chrome||!chrome.contextMenus){console.warn("No access to chrome.contextMenus");return}chrome.contextMenus.removeAll(),this.browserActionContextMenu.forEach(e=>chrome.contextMenus.create(e.menu)),chrome.contextMenus.onClicked.addListener(this.onClick)};this.onClick=(e,n)=>{let o=this.browserActionContextMenu.find(s=>s.menu.id===e.menuItemId);o?o.handler(e,n):console.error("Unable to find menu item: ",e)}}sendMessage(e){chrome.tabs.query({active:!0,currentWindow:!0},n=>{chrome.tabs.sendMessage(n[0].id,e,o=>{console.debug("ack:",o)})})}};new r().init();var c="https://forms.gle/iE1DgamFFEy2g2fDA",a=chrome.runtime.getURL("welcome/welcome.html"),i=t=>{t.reason==="install"&&chrome.tabs.create({url:a,active:!0}),chrome.runtime.setUninstallURL(c,()=>{chrome.runtime.lastError&&console.error("Error setting uninstall URL",chrome.runtime.lastError)})};chrome.runtime.onInstalled.addListener(i);var l=(t,e,n)=>{console.log("Received message: ",t," from: ",e),chrome.tabs.query({active:!0,currentWindow:!0},o=>{if(o.length==0){console.error("Unexpected state: No active tab");return}chrome.tabs.sendMessage(o[0].id,t,s=>{n(s)})})};chrome.runtime.onMessage.addListener(l);chrome.action.onClicked.addListener(t=>{if(!t.id){console.error("BG: click on tab without an id",t);return}let e=t.url;if(!e||!e.trim()||e.startsWith("chrome-extension://")||e.startsWith("chrome://")||e.startsWith("https://chrome.google.com/webstore")){chrome.tabs.create({url:`chrome-extension://${chrome.i18n.getMessage("@@extension_id")}/standalone/calc.html?unsupportedHost`,active:!0},()=>{console.log("successfully created Floating Calculator tab for unsupported host.")});return}chrome.tabs.sendMessage(t.id,{action:"toggle-calculator"},n=>{console.log("BG: received",n)})});})();
